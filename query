eval line = replace(line,"\n","@") 
| rex field=line "\[(?<Time>\d{2}-\d{2} \d{2}:\d{2}:\d{2} \d{3})\]\s+\[T:(?<THREADID>.*?)\]\s+\[\w:(?<LEVEL>\w+)\]\s+\[(?<CLASSINFO>\S+)\]\s+\[\w+:(?<PKG>\w+)\](?<TEXT>.*)" 
| rex field=TEXT "\[TXN:(?<TRANSACTIONID>\w+)\]\[CN:(?<CN>\w+)\]\D+?(?<LOGTYPE>\D{2}?\w?)" 
| eval LOGTYPE =  if(contains(LOGTYPE, "F:"),substr(LOGTYPE, indexof(LOGTYPE, "F:")+2), null), line=replace(line,"@","\n"), TEXT=replace(TEXT,"@","\n")
